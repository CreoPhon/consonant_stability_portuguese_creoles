Correlation between typological frequency, borrowability and stability
================
Carlos Silva
2023-06-02

- [Preparation](#preparation)
  - [Loading packages](#loading-packages)
  - [Getting ordinal data](#getting-ordinal-data)
  - [Creating dataframes](#creating-dataframes)
    - [For non-parametric tests](#for-non-parametric-tests)
    - [For Spearman’s rank correlation
      coefficient](#for-spearmans-rank-correlation-coefficient)
- [Non-parametric tests](#non-parametric-tests)
  - [Friedman test](#friedman-test)
  - [Conover’s all-pairs test](#conovers-all-pairs-test)
  - [Durbin’s all-pairs test](#durbins-all-pairs-test)
  - [Spearman’s Correlation
    Coefficient](#spearmans-correlation-coefficient)
    - [Stability~Borrowability](#stabilityborrowability)
    - [Stability~Typological frequency](#stabilitytypological-frequency)
- [Plots](#plots)
  - [Box plots](#box-plots)
  - [Bump chart](#bump-chart)

# Preparation

## Loading packages

``` r
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.2     ✔ readr     2.1.4
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.0
    ## ✔ ggplot2   3.4.2     ✔ tibble    3.2.1
    ## ✔ lubridate 1.9.2     ✔ tidyr     1.3.0
    ## ✔ purrr     1.0.1     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
library(PMCMRplus)
library(ggpubr)
library(rstatix)
```

    ## 
    ## Attaching package: 'rstatix'
    ## 
    ## The following object is masked from 'package:stats':
    ## 
    ##     filter

``` r
library(stats)
```

## Getting ordinal data

Ordinal data was generated by ranking the percentage values of
stability, borrowability and typological frequency from 1 to 19.
Duplicate values summed and averaged in the ranking.

1)  Cross linguistic frequency

``` r
order_typ <- c(1,
2   ,
3   ,
4   ,
5   ,
5   ,
7   ,
8   ,
9   ,
10  ,
11.5    ,
11.5    ,
13  ,
14  ,
15  ,
16  ,
17  ,
18  ,
19)
consonant <- c("m",
             "k",
             "p",
             "n",
             "t",
             "l",
             "s",
             "b",
             "g",
             "d",
             "f",
             "r",
             "ɲ",
             "t̠ʃ",
             "z",
             "v",
             "ɾ",
             "ʒ",
             "ʎ")
df_typ <- data.frame(order_typ, consonant)
```

2)  Borrowability

``` r
order_bor <- c(1    ,
2   ,
3   ,
4   ,
5   ,
6   ,
6   ,
8   ,
9   ,
10  ,
11  ,
12  ,
13  ,
14.5    ,
14.5    ,
16  ,
17  ,
18  ,
19)
consonant <- c("f",
              "g",
              "t̠ʃ",
              "b",
              "z",
              "v",
              "d",
              "r",
              "p",
              "l",
              "s",
              "ʒ",
              "ɾ",
              "ɲ",
              "k",
              "ʎ",
              "t",
              "n",
              "m")
df_bor <- data.frame(order_bor, consonant)
```

3)  Stability values

``` r
order_sta <- c(3,
3   ,
3   ,
3   ,
3   ,
6   ,
8   ,
8   ,
8   ,
10  ,
11  ,
12  ,
13  ,
14  ,
15  ,
16  ,
17  ,
18  ,
19)
consonant <- c("t",
               "p",
               "n",
               "m",
               "f",
               "b",
               "k",
               "g",
               "d",
               "z",
               "s",
               "l",
               "r",
               "t̠ʃ",
               "ɾ",
               "ɲ",
               "ʒ",
               "ʎ",
               "v")
df_sta <- data.frame(order_sta, consonant)
```

## Creating dataframes

### For non-parametric tests

Long format with joint groups

``` r
df_friedman <- left_join(df_sta, df_bor, by="consonant")

order_df <- left_join(df_friedman, df_typ, by="consonant")
head(order_df)
```

    ##   order_sta consonant order_bor order_typ
    ## 1         3         t        17       5.0
    ## 2         3         p         9       3.0
    ## 3         3         n        18       4.0
    ## 4         3         m        19       1.0
    ## 5         3         f         1      11.5
    ## 6         6         b         4       8.0

``` r
df_long <- order_df %>% gather(key = "conditions", 
                         value = "order", order_bor, order_sta, order_typ)

head(df_long)
```

    ##   consonant conditions order
    ## 1         t  order_bor    17
    ## 2         p  order_bor     9
    ## 3         n  order_bor    18
    ## 4         m  order_bor    19
    ## 5         f  order_bor     1
    ## 6         b  order_bor     4

### For Spearman’s rank correlation coefficient

Large format and separated groups

``` r
df_sta_bor <- left_join(df_sta, df_bor, by="consonant")
df_sta_typ <- left_join(df_sta, df_typ, by="consonant")
```

Converting to long format

``` r
sta_bor_long <- df_sta_bor %>% gather(key = "conditions", 
                                    value = "order", order_bor, order_sta)
sta_typ_long <- df_sta_typ %>% gather(key = "conditions", 
                                      value = "order", order_typ, order_sta)
```

# Non-parametric tests

Statistical summary

``` r
df_long %>% group_by(conditions) %>%  summarise(n = n(), mean = mean(order), 
                                               sd = sd(order))
```

    ## # A tibble: 3 × 4
    ##   conditions     n  mean    sd
    ##   <chr>      <int> <dbl> <dbl>
    ## 1 order_bor     19  9.95  5.66
    ## 2 order_sta     19 10     5.57
    ## 3 order_typ     19  9.95  5.67

A first plot

``` r
ggplot(df_long, aes(x = consonant, y = order)) + geom_boxplot(outlier.shape = NA) + 
  geom_jitter(width = 0.2) + theme(legend.position="top")
```

![](Typology_borrowability_stability_files/figure-gfm/unnamed-chunk-9-1.png)<!-- -->

## Friedman test

``` r
friedman.test(y = df_long$order, groups = df_long$conditions, blocks = df_long$consonant)
```

    ## 
    ##  Friedman rank sum test
    ## 
    ## data:  df_long$order, df_long$conditions and df_long$consonant
    ## Friedman chi-squared = 2.4932, df = 2, p-value = 0.2875

``` r
df_long %>% friedman_effsize(order ~ conditions | consonant)
```

    ## # A tibble: 1 × 5
    ##   .y.       n effsize method    magnitude
    ## * <chr> <int>   <dbl> <chr>     <ord>    
    ## 1 order    19  0.0656 Kendall W small

## Conover’s all-pairs test

``` r
frdAllPairsConoverTest(
  y = df_long$order, 
  groups = df_long$conditions, 
  blocks = df_long$consonant, 
  p.adjust.method = "bonf")
```

    ## 
    ##  Pairwise comparisons using Conover's all-pairs test for a two-way balanced complete block design

    ## data: y, groups and blocks

    ##           order_bor order_sta
    ## order_sta 0.58      -        
    ## order_typ 0.50      1.00

    ## 
    ## P value adjustment method: bonferroni

## Durbin’s all-pairs test

``` r
durbinAllPairsTest(
  y      = df_long$order, 
  groups = df_long$conditions, 
  blocks = df_long$consonant,
  p.adjust.method = "holm")
```

    ## 
    ##  Pairwise comparisons using Durbin's all-pairs test for a two-way balanced incomplete block design

    ## data: df_long$order, df_long$conditions and df_long$consonant

    ##           order_bor order_sta
    ## order_sta 0.50      -        
    ## order_typ 0.50      0.93

    ## 
    ## P value adjustment method: holm

## Spearman’s Correlation Coefficient

### Stability~Borrowability

``` r
cor.test(x=df_sta_bor$order_bor, 
         y=df_sta_bor$order_sta, 
         method = 'spearman')
```

    ## Warning in cor.test.default(x = df_sta_bor$order_bor, y = df_sta_bor$order_sta,
    ## : Cannot compute exact p-value with ties

    ## 
    ##  Spearman's rank correlation rho
    ## 
    ## data:  df_sta_bor$order_bor and df_sta_bor$order_sta
    ## S = 1181.5, p-value = 0.8824
    ## alternative hypothesis: true rho is not equal to 0
    ## sample estimates:
    ##        rho 
    ## -0.0363815

### Stability~Typological frequency

``` r
cor.test(x=df_sta_typ$order_typ, 
         y=df_sta_typ$order_sta, 
         method = 'spearman')
```

    ## Warning in cor.test.default(x = df_sta_typ$order_typ, y = df_sta_typ$order_sta,
    ## : Cannot compute exact p-value with ties

    ## 
    ##  Spearman's rank correlation rho
    ## 
    ## data:  df_sta_typ$order_typ and df_sta_typ$order_sta
    ## S = 240.7, p-value = 5.972e-05
    ## alternative hypothesis: true rho is not equal to 0
    ## sample estimates:
    ##       rho 
    ## 0.7888575

# Plots

## Box plots

Stability vs typological frequency

``` r
ggplot(sta_typ_long, aes(x = consonant, y = order)) + geom_boxplot(outlier.shape = NA) + 
  geom_jitter(width = 0.2) + theme(legend.position="top")
```

![](Typology_borrowability_stability_files/figure-gfm/unnamed-chunk-15-1.png)<!-- -->

Stability vs borrowability

``` r
ggplot(sta_bor_long, aes(x = consonant, y = order)) + geom_boxplot(outlier.shape = NA) + 
  geom_jitter(width = 0.2) + theme(legend.position="top")
```

![](Typology_borrowability_stability_files/figure-gfm/unnamed-chunk-16-1.png)<!-- -->

## Bump chart

``` r
ggplot(data = df_long, aes(x = conditions, y = order, group = consonant)) +
  geom_line(aes(color = consonant, alpha = 1), size = 1) +
  geom_point(aes(color = consonant, alpha = 1), size = 2,  alpha = 0.8) +
  scale_y_reverse(breaks = 1:nrow(df_long)) +
  scale_alpha(guide = 'none') +
  #theme(legend.position="bottom") +
  theme( panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank())
```

    ## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
    ## ℹ Please use `linewidth` instead.
    ## This warning is displayed once every 8 hours.
    ## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
    ## generated.

![](Typology_borrowability_stability_files/figure-gfm/unnamed-chunk-17-1.png)<!-- -->

``` r
    #theme(panel.background = element_rect(color="white")) +
    #theme(plot.background  = element_rect(color="white")) +
    #theme(panel.border     = element_rect(color="white")) +
    #theme(strip.background = element_rect(color="white"))
```
